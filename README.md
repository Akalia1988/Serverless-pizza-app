# Serverless-pizza-app

BUILDING A MULTI-TIER SERVERLESS APPLICATION IN AWS


![image](https://user-images.githubusercontent.com/58148717/118533249-7593a400-b70d-11eb-823c-b67b8667f0e1.png)

We will create a multi-tier serverless architecture on AWS using Amazon API Gateway, AWS Lambda, AWS Step Functions, and Amazon Polly text to speech. We create serverless 
functions, data access, business logic, and integration layers on AWS. 
We Will also learn how to create a presentation layer for our application using the client SDK generated by Amazon API Gateway. We will then host the application on Amazon S3.
 
What do we need to create first?
To start, we'll first need to create a table in DynamoDB to which our Lambda functions will write to and re-prompt go to our DynamoDB console and create a table, let's call it Orders and choose Order ID as a primary key. 
We don't need to do anything else here since it's a NoSQL Database, and we can insert our records later through the Lambda function in the format we like.

create our Lambda functions using a CloudFormation template or put in S3 so CloudFormation template can access it.

All of the Lambda functions are in .js files, and I'll zip them all up as Lambda Functions.zip and upload to the bucket. From here, the CloudFormation template can access the code. Check out the cloudformation.yaml above. 

This template creates a role which our Lambda functions will use. It has a AssumeRolePolicyDocument property, which is a trust policy associated with this role, which will allow Lambda functions to assume its role. It also has these ManagePolicyArns that give it full access to S3, DynamoDB and Amazon Polly, as required by our Lambda functions. Then we create our five Lambda functions through the template. If you look at the first Lambda function, PlaceOrder, it has the type of Lambda function, and properties including description, function name, a handler, which is the function Lambda will invoke, and 
since we've saved our Node.js function as PlaceOrder.js, the handler will be PlaceOrder.handler. For role, we'll get the ARN of the role created earlier in the template. The template also creates an IAM role.

AWS state machine

we'll use Step Functions to create a state machine to orchestrate our Lambda Functions. State machine is just a visual workflow representation that lets you arrange and coordinate discrete components of our distributed application

State machine is built using JSON notation, and the Step Functions console gives us quite a few blueprints to start with. So we will  just choose the ChoiceState blueprint. Check orderflow.json for more details we will insert Lambda Function ARN in resourse it can be done through console easily. 

![image](https://user-images.githubusercontent.com/58148717/118534009-6103db80-b70e-11eb-9afe-e269cf988c59.png)


Rest Interface for our State machine with API Gateway.

let's go to the API Gateway console and create a new API and create a POST method.

For integration type select AWS Service and then the region where your step function's located

For HTTP method choose POST.

Give the ARN role (or create it for the API gateway) we'll give full access to step function's policy also attached to it and then just click on save

Now let's create a get method.which will retrieve the details of our execution including input, output and start and end dates etc. Under the root resource create a get method
follow the same step as above.

We'll also need to enable calls here to allow access to requests from domains other than the API domain itself ( we would need to enable CORS) so anyone can call to our API's

One last thing before our API is ready for prime time is to deploy the API on a stage so that we can generate the client SDK required for front end development.


![image](https://user-images.githubusercontent.com/58148717/118534184-8f81b680-b70e-11eb-825b-f63833740056.png)


Create front end for Rest API.

Now we will invoke the methods in the API through a client, we'll need to download the client SDK generated by API Gateway, 
which will provide us with AJAX calls to invoke the API. I'll go to the API Gateway console and under the Stage, there is the SDK Generation tab. 
We will choose our platform as JavaScript and generate the SDK. If you unzip this package, it includes all the libraries and object definitions necessary to make calls to the API. 
The README file has instructions on which third-party scripts to include and how to initiate an API Gateway client.

We can host the host our static website on S3 or do some styling and yeah our pizza website is ready for online orders.


![image](https://user-images.githubusercontent.com/58148717/118539027-88f63d80-b714-11eb-9ab1-8f19a749d3a8.png)




















